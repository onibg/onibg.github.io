<meta charset="UTF-8">
<title>raw檔429測試</title>
<script>
/*
const test0=async()=>{return 42}
const test1=async()=>{return Promise.resolve(42)}
const test2=async()=>{return await Promise.resolve(42)}//await多餘
;(async()=>{
console.log(test0())
console.log(test1())
console.log(test2())
})()
*/


/*
var Old
setInterval(async()=>{
 const New=await getData()
 console.log(New)
 if(New!=Old)console.log(new Date())
 Old=New
},1000)
*/


(async()=>{
 for(let j=0;j<10;j++){
  const promises=[]
  for(let i=0;i<100;i++){
   const Return=getData(i)
   promises.push(Return)
  }
  const results=await Promise.all(promises)
  results.forEach((item,index)=>{item[0]=j*100+item[0];console.log(item)})
  console.log(await delay(1000))
 }
})()

async function getData(i){
 const res=await fetch('https://raw.githubusercontent.com/onibg/onibg.github.io/main/test_html/49.html',{method:'GET',cache:'no-store'})
 const data=await res.text()
 return [i,data]
 //console.log(i,data)
}

const delay=ms=>new Promise(resolve=>setTimeout(()=>resolve(`延遲${ms}毫秒`),ms))




</script>
